import*as s from"react";import{FieldArray as we,Form as Le,Formik as Ve}from"formik";import*as l from"yup";var P=t=>t?.map(e=>e.value),ue={required:"Required",date:"Should be valid date format",string:"Should be valid string",number:"Should be valid number"};function A(t=ue){return l.object().shape({filters:l.array().of(l.object().shape({id:l.object().shape({label:l.string().required(),value:l.string().required(),type:l.string().required()}).nullable().required(t.required),values:l.array().when("id",{is:e=>e&&e.type?e.type==="number":!1,then:l.array().transform(e=>P(e)).of(l.number().typeError(t.number)).required(t.required)}).when("id",{is:e=>e&&e.type?e.type==="date":!1,then:l.array().transform(e=>P(e)).of(l.date().typeError(t.date)).required(t.required)}).when("id",{is:e=>e&&e.type?e.type!=="date"&&e.type!=="number":!1,then:l.array().transform(e=>P(e)).of(l.number().typeError(t.string)).required(t.required)}),operator:l.string().nullable().required(t.required)}))})}import*as d from"react";import*as R from"react";var Y="number",B="string",D="boolean",H="date",_="enum",M="source";import*as S from"react";import{Field as ve}from"formik";import*as F from"react";import fe from"classnames";import*as g from"react";var de=()=>g.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g.createElement("rect",{width:"16",height:"16",fill:"white",fillOpacity:"0.01"}),g.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5109 2.65516C8.67288 2.72228 8.82004 2.82065 8.94399 2.94466L13.056 7.05599C13.1801 7.17995 13.2786 7.32716 13.3457 7.48919C13.4129 7.65123 13.4475 7.82492 13.4475 8.00033C13.4475 8.17574 13.4129 8.34943 13.3457 8.51146C13.2786 8.6735 13.1801 8.8207 13.056 8.94466L8.94399 13.056C8.82004 13.18 8.67288 13.2784 8.5109 13.3455C8.34893 13.4126 8.17532 13.4472 7.99999 13.4472C7.82466 13.4472 7.65104 13.4126 7.48907 13.3455C7.3271 13.2784 7.17993 13.18 7.05599 13.056L2.94399 8.94466C2.81988 8.8207 2.72142 8.6735 2.65424 8.51146C2.58707 8.34943 2.55249 8.17574 2.55249 8.00033C2.55249 7.82492 2.58707 7.65123 2.65424 7.48919C2.72142 7.32716 2.81988 7.17995 2.94399 7.05599L7.05599 2.94466C7.17993 2.82065 7.3271 2.72228 7.48907 2.65516C7.65104 2.58804 7.82466 2.5535 7.99999 2.5535C8.17532 2.5535 8.34893 2.58804 8.5109 2.65516ZM7.52858 9.13806C7.6536 9.26308 7.82317 9.33332 7.99998 9.33332C8.1768 9.33332 8.34636 9.26308 8.47139 9.13806C8.59641 9.01304 8.66665 8.84347 8.66665 8.66666V5.33332C8.66665 5.15651 8.59641 4.98694 8.47139 4.86192C8.34636 4.73689 8.1768 4.66666 7.99998 4.66666C7.82317 4.66666 7.6536 4.73689 7.52858 4.86192C7.40356 4.98694 7.33332 5.15651 7.33332 5.33332V8.66666C7.33332 8.84347 7.40356 9.01304 7.52858 9.13806ZM7.52858 11.1381C7.6536 11.2631 7.82317 11.3333 7.99998 11.3333C8.1768 11.3333 8.34636 11.2631 8.47139 11.1381C8.59641 11.013 8.66665 10.8435 8.66665 10.6667C8.66665 10.4898 8.59641 10.3203 8.47139 10.1953C8.34636 10.0702 8.1768 9.99999 7.99998 9.99999C7.82317 9.99999 7.6536 10.0702 7.52858 10.1953C7.40356 10.3203 7.33332 10.4898 7.33332 10.6667C7.33332 10.8435 7.40356 11.013 7.52858 11.1381Z",fill:"#DE350B"})),q=de;var Fe=t=>{let{children:e,label:i="",isError:r,error:o}=t,a=fe("filter-field-control",{isError:r});return F.createElement("div",{className:a},i&&F.createElement("label",null,i),F.createElement("div",{className:"filter-field-control__field"},e),F.createElement("span",{className:"filter-field-control__error"},r&&F.createElement("span",null,F.createElement(q,null),o)))},C=Fe;import*as k from"react";import{AsyncPaginate as Ce}from"react-select-async-paginate";var ye=t=>{let{...e}=t;return k.createElement(Ce,{additional:{page:1},...e})},W=ye;var Re=t=>{let{name:e,label:i,onChange:r,...o}=t;return S.createElement(ve,{name:e},a=>{let{field:c,meta:n,form:p}=a,m=n.touched&&!!n.error;return S.createElement(C,{isError:m,error:n.error,label:i},S.createElement(W,{...o,...c,onBlur:()=>p.setFieldTouched(e,!0),onChange:u=>{r&&r(u),p.setFieldValue(e,u)}}))})},U=Re;import*as I from"react";import{Field as Te}from"formik";import*as Z from"react";import be from"react-select/async-creatable";var he=function(t){let{options:e,isError:i,...r}=t;return Z.createElement(be,{defaultOptions:e,...r})},$=he;var xe=t=>{let{name:e,label:i,onChange:r,...o}=t;return I.createElement(Te,{name:e},a=>{let{field:c,meta:n,form:p}=a,m=n.touched&&!!n.error;return I.createElement(C,{isError:m,error:n.error,label:i},I.createElement($,{...o,...c,onBlur:()=>p.setFieldTouched(e,!0),onChange:u=>{r&&r(u),p.setFieldValue(e,u)}}))})},y=xe;var ge=({type:t,name:e,valueOptions:i,loadOptions:r,classNamePrefix:o})=>{switch(t){case M:return R.createElement(U,{name:e,isMulti:!0,loadOptions:r,classNamePrefix:o,placeholder:""});case(B||D||H||_||Y):return R.createElement(y,{name:e,isMulti:!0,classNamePrefix:o,placeholder:""});case _:return R.createElement(y,{name:e,options:i,isMulti:!0,classNamePrefix:o,placeholder:""});default:return R.createElement(y,{name:e,isMulti:!0,classNamePrefix:o,placeholder:""})}},z=ge;import*as b from"react";import{Field as Ee}from"formik";import w from"react";import Ie from"classnames";import*as N from"react";var Se=()=>N.createElement("svg",{height:"20",width:"20",viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",className:"css-tj5bde-Svg"},N.createElement("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"})),G=Se;var Oe=t=>{let{isError:e,children:i,className:r,...o}=t,a=Ie("field-select",r,{isError:e});return w.createElement("div",{className:a},w.createElement("select",{autoComplete:"off",...o},i),w.createElement(G,null))},J=Oe;var Pe=t=>{let{name:e,options:i=[],disabled:r,label:o,id:a,className:c}=t;return b.createElement(Ee,{name:e},n=>{let{field:p,meta:m}=n,u=m.touched&&!!m.error;return b.createElement(C,{isError:u,error:m.error,label:o},b.createElement(J,{id:a,...p,isError:u,disabled:r,className:c},i.map(v=>b.createElement("option",{key:v.value,value:v.value},v.key))))})},K=Pe;import*as V from"react";import X from"classnames";import*as L from"react";var Ae=()=>L.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},L.createElement("path",{d:"M18.222 7.111H15.111V5.556C15.111 5.1435 14.9472 4.74787 14.6556 4.4561C14.364 4.16432 13.9685 4.00027 13.556 4H10.444C10.0315 4.00027 9.63598 4.16432 9.34439 4.4561C9.0528 4.74787 8.889 5.1435 8.889 5.556V7.111H5.778C5.57166 7.111 5.37377 7.19297 5.22787 7.33887C5.08197 7.48477 5 7.68266 5 7.889C5 8.09534 5.08197 8.29323 5.22787 8.43913C5.37377 8.58503 5.57166 8.667 5.778 8.667H6.486L7.461 19.457C7.4827 19.6964 7.59309 19.9191 7.77051 20.0814C7.94793 20.2436 8.17958 20.3337 8.42 20.334H15.507C15.7677 20.3341 16.0189 20.2366 16.2114 20.0608C16.4038 19.885 16.5235 19.6436 16.547 19.384L17.515 8.668H18.223C18.3252 8.66787 18.4263 8.64761 18.5207 8.6084C18.615 8.56918 18.7007 8.51176 18.7728 8.43942C18.845 8.36709 18.9022 8.28125 18.9412 8.1868C18.9801 8.09236 19.0001 7.99117 19 7.889C19 7.68266 18.918 7.48477 18.7721 7.33887C18.6262 7.19297 18.4283 7.111 18.222 7.111ZM10.444 5.556H13.555V7.111H10.444V5.556ZM15.044 18.778H8.96L8.047 8.667H15.952L15.044 18.778Z",fill:"#94A0B5"})),Q=Ae;var _e=({className:t="",...e})=>{let i=X("remove-button",X);return V.createElement("button",{...e,className:i,type:"button"},V.createElement(Q,null))},j=_e;var Ne=t=>{let{idOptions:e,loadOptions:i,operatorOptions:r,filterType:o,valueOptions:a,onRemove:c,onChangeIdSelect:n,index:p}=t;return d.createElement("div",{className:"filter-row"},d.createElement("div",{className:"filter-row__field filter-row__field__id"},d.createElement(y,{classNamePrefix:"select-id",name:`filters[${p}].id`,options:e,onChange:n})),d.createElement("div",{className:"filter-row__field filter-row__field__operator"},d.createElement(K,{className:"select-operator",name:`filters[${p}].operator`,options:r})),d.createElement("div",{className:"filter-row__field filter-row__field__values"},d.createElement(z,{classNamePrefix:"select-values",name:`filters[${p}].values`,type:o,valueOptions:a,loadOptions:i})),d.createElement("div",{className:"filter-row__field filter-row__remove"},d.createElement(j,{onClick:()=>c(p)})))},ee=Ne;var te=(t,e)=>({filters:t.filters?.length?t.filters.map(r=>{let o=e.find(a=>r.id.value===a.value);return{values:r.values,operator:r.operator,id:o}}):[]}),re=t=>t.map(e=>{let{caption:i,id:r,values:o,operators:a,...c}=e,n;Array.isArray(o)?n=o.map(m=>({label:m.name,value:String(m.id)})):n=o;let p=a.map(m=>({key:m,value:m}));return{label:i,value:String(r),values:n,operators:[{key:"",value:""},...p],...c}}),oe=t=>({filters:t.filters.map(r=>{let{id:o,...a}=r;return{...a,id:{label:o.label,value:o.value}}})});var Ye=t=>{let{onSubmitFilterForm:e,initialFilters:i,filtersTypesList:r,onRemoveFilter:o,onAddFilter:a,onLoadSourceOptions:c,addFilterButtonText:n,submitFilterButtonText:p,idLabelText:m,operatorLabelText:u,valuesLabelText:v,validationMessages:ae}=t,O=re(r),le=te(i,O);return s.createElement(Ve,{onSubmit:(h,T)=>{let E=oe(h);e&&e(E)},initialValues:le,validationSchema:A(ae),enableReinitialize:!0},s.createElement(Le,null,s.createElement(we,{name:"filters"},h=>{let{form:T,push:E,remove:se}=h,{filters:ne}=T.values,pe=f=>{se(f),o&&o(f)},me=()=>{let[f=null]=O;E({id:f,operator:"",values:[]}),a&&a(h)};return s.createElement("div",{className:"filter-list"},s.createElement("div",{className:"filter-list-labels"},s.createElement("label",null,m),s.createElement("label",null,u),s.createElement("label",null,v),s.createElement("div",{style:{width:36}})),s.createElement("ul",{className:"filter-list__items"},ne.map((f,x)=>{let ce=()=>{T.setFieldValue(`filters[${x}].operator`,""),T.setFieldValue(`filters[${x}].values`,null)};return s.createElement("li",{className:"filter-list__item",key:x},s.createElement(ee,{loadOptions:c(f?.id?.value),filterType:f?.id?.type,onChangeIdSelect:ce,idOptions:O,operatorOptions:f?.id?.operators,valueOptions:f?.id?.values,onRemove:pe,index:x}))})),s.createElement("div",{className:"button-group"},s.createElement("div",{className:"filter-list-button"},s.createElement("button",{type:"button",onClick:me},n)),s.createElement("div",{className:"filter-list-button"},s.createElement("button",{type:"submit"},p))))})))},ie=Ye;export{ie as TableFiltersClient};
//# sourceMappingURL=index.js.map
