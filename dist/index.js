import*as n from"react";import{FieldArray as De,Form as qe,Formik as ke}from"formik";import*as l from"yup";var A=e=>e?.map(t=>t.value),ve={required:"Required",date:"Should be valid date format",string:"Should be valid string",number:"Should be valid number"};function _(e=ve){return l.object().shape({filters:l.array().of(l.object().shape({id:l.object().shape({label:l.string().required(),value:l.string().required(),type:l.string().required()}).nullable().required(e.required),values:l.lazy((t,i)=>{let o=i&&i.parent&&i.parent.id&&i.parent.id.type?i.parent.id.type:"";return o==="number"?l.array().transform(r=>A(r)).of(l.number().typeError(e.number)).required(e.required):o==="date"?l.array().transform(r=>A(r)).of(l.date().typeError(e.date)).required(e.required):o==="boolean"?l.boolean():l.array().transform(r=>A(r)).of(l.number().typeError(e.string)).required(e.required)}),operator:l.string().nullable().required(e.required)}))})}import*as c from"react";import*as y from"react";var M="number",D="string",q="boolean",k="date",N="enum",W="source";import*as S from"react";import{Field as Te}from"formik";import*as b from"react";import ye from"classnames";var Ce=e=>{let{children:t,label:i="",isError:o,error:r}=e,a=ye("filter-field-control",{isError:o});return b.createElement("div",{className:a},i&&b.createElement("label",null,i),b.createElement("div",{className:"filter-field-control__field"},t),b.createElement("span",{className:"filter-field-control__error"},o&&b.createElement("span",null,r)))},F=Ce;import*as U from"react";import{AsyncPaginate as Re}from"react-select-async-paginate";var he=e=>{let{...t}=e;return U.createElement(Re,{additional:{page:1},...t})},$=he;var xe=e=>{let{name:t,label:i,onChange:o,...r}=e;return S.createElement(Te,{name:t},a=>{let{field:p,meta:s,form:u}=a,m=s.touched&&!!s.error;return S.createElement(F,{isError:m,error:s.error,label:i},S.createElement($,{...r,...p,onBlur:()=>u.setFieldTouched(t,!0),onChange:d=>{o&&o(d),u.setFieldValue(t,d)}}))})},j=xe;import*as g from"react";import{Field as Ee}from"formik";import*as z from"react";import Se from"react-select/async-creatable";var ge=function(e){let{options:t,isError:i,...o}=e;return z.createElement(Se,{defaultOptions:t,...o})},Z=ge;var Pe=e=>{let{name:t,label:i,onChange:o,...r}=e;return g.createElement(Ee,{name:t},a=>{let{field:p,meta:s,form:u}=a,m=s.touched&&!!s.error;return g.createElement(F,{isError:m,error:s.error,label:i},g.createElement(Z,{...r,...p,onBlur:()=>u.setFieldTouched(t,!0),onChange:d=>{o&&o(d),u.setFieldValue(t,d)}}))})},v=Pe;import E from"react";import{Field as Ae}from"formik";import O from"react";var Ie=e=>{let{isError:t,...i}=e;return O.createElement("label",{className:`field-switch ${t?"isError":""}`},O.createElement("input",{type:"checkbox",className:"field-switch__input",...i}),O.createElement("span",{className:"field-switch__slider field-switch__slider--round"}))},G=Ie;var _e=e=>{let{name:t,label:i,...o}=e;return E.createElement(Ae,{name:t},r=>{let{field:a,meta:p}=r,s=p.touched&&!!p.error;return E.createElement(F,{isError:s,error:p.error,label:i},E.createElement("div",{className:"app-switcher"},E.createElement(G,{isError:s,...o,...a,checked:a.value}),a.value?"On":"Off"))})},J=_e;var Ne=({type:e,name:t,valueOptions:i,loadOptions:o,classNamePrefix:r})=>{switch(e){case W:return y.createElement(j,{name:t,isMulti:!0,loadOptions:o,classNamePrefix:r,placeholder:""});case q:return y.createElement(J,{name:t,placeholder:""});case(D||k||N||M):return y.createElement(v,{name:t,isMulti:!0,classNamePrefix:r,placeholder:""});case N:return y.createElement(v,{name:t,options:i,isMulti:!0,classNamePrefix:r,placeholder:""});default:return y.createElement(v,{name:t,isMulti:!0,classNamePrefix:r,placeholder:""})}},K=Ne;import*as R from"react";import{Field as Ye}from"formik";import w from"react";import Le from"classnames";import*as L from"react";var Oe=()=>L.createElement("svg",{height:"20",width:"20",viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",className:"css-tj5bde-Svg"},L.createElement("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"})),Q=Oe;var we=e=>{let{isError:t,children:i,className:o,...r}=e,a=Le("field-select",o,{isError:t});return w.createElement("div",{className:a},w.createElement("select",{autoComplete:"off",...r},i),w.createElement(Q,null))},X=we;var Be=e=>{let{name:t,options:i=[],disabled:o,label:r,id:a,className:p}=e;return R.createElement(Ye,{name:t},s=>{let{field:u,meta:m}=s,d=m.touched&&!!m.error;return R.createElement(F,{isError:d,error:m.error,label:r},R.createElement(X,{id:a,...u,isError:d,disabled:o,className:p},i.map(C=>R.createElement("option",{key:C.value,value:C.value},C.key))))})},ee=Be;import*as B from"react";import re from"classnames";import*as Y from"react";var Ve=()=>Y.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Y.createElement("path",{d:"M18.222 7.111H15.111V5.556C15.111 5.1435 14.9472 4.74787 14.6556 4.4561C14.364 4.16432 13.9685 4.00027 13.556 4H10.444C10.0315 4.00027 9.63598 4.16432 9.34439 4.4561C9.0528 4.74787 8.889 5.1435 8.889 5.556V7.111H5.778C5.57166 7.111 5.37377 7.19297 5.22787 7.33887C5.08197 7.48477 5 7.68266 5 7.889C5 8.09534 5.08197 8.29323 5.22787 8.43913C5.37377 8.58503 5.57166 8.667 5.778 8.667H6.486L7.461 19.457C7.4827 19.6964 7.59309 19.9191 7.77051 20.0814C7.94793 20.2436 8.17958 20.3337 8.42 20.334H15.507C15.7677 20.3341 16.0189 20.2366 16.2114 20.0608C16.4038 19.885 16.5235 19.6436 16.547 19.384L17.515 8.668H18.223C18.3252 8.66787 18.4263 8.64761 18.5207 8.6084C18.615 8.56918 18.7007 8.51176 18.7728 8.43942C18.845 8.36709 18.9022 8.28125 18.9412 8.1868C18.9801 8.09236 19.0001 7.99117 19 7.889C19 7.68266 18.918 7.48477 18.7721 7.33887C18.6262 7.19297 18.4283 7.111 18.222 7.111ZM10.444 5.556H13.555V7.111H10.444V5.556ZM15.044 18.778H8.96L8.047 8.667H15.952L15.044 18.778Z",fill:"#94A0B5"})),te=Ve;var He=({className:e="",...t})=>{let i=re("remove-button",re);return B.createElement("button",{...t,className:i,type:"button"},B.createElement(te,null))},oe=He;var Me=e=>{let{loadOptions:t,filterType:i,onRemove:o,onChangeField:r,index:a,options:p,RemoveFilterButton:s}=e;return c.createElement("div",{className:"filter-row"},c.createElement("div",{className:"filter-row__field filter-row__field__id"},c.createElement(v,{classNamePrefix:"select-id",name:`filters[${a}].id`,options:p.fields,onChange:r})),c.createElement("div",{className:"filter-row__field filter-row__field__operator"},c.createElement(ee,{className:"select-operator",name:`filters[${a}].operator`,options:p.operators})),c.createElement("div",{className:"filter-row__field filter-row__field__values"},c.createElement(K,{classNamePrefix:"select-values",name:`filters[${a}].values`,type:i,valueOptions:p.values,loadOptions:t})),c.createElement("div",{className:"filter-row__field filter-row__remove",onClick:()=>o(a)},s?c.createElement(s,null):c.createElement(oe,null)))},ie=Me;var ae=(e,t)=>({filters:e.filters?.length?e.filters.map(o=>{let r=t.find(a=>o.id.value===a.value);return{values:o.values,operator:o.operator,id:r}}):[]}),le=e=>e.map(t=>{let{caption:i,id:o,values:r,operators:a,...p}=t,s;Array.isArray(r)?s=r.map(m=>({label:m.name,value:String(m.id)})):s=r;let u=a.map(m=>({key:m,value:m}));return{label:i,value:String(o),values:s,operators:[{key:"",value:""},...u],...p}}),se=e=>({filters:e.filters.map(o=>{let{id:r,...a}=o;return{...a,id:{label:r.label,value:r.value}}})});var We=e=>{let{onSubmitFilterForm:t,initialFilters:i,filtersTypesList:o,onRemoveFilter:r,onAddFilter:a,onLoadSourceOptions:p,addFilterButtonText:s,submitFilterButtonText:u,idLabelText:m,operatorLabelText:d,valuesLabelText:C,validationMessages:pe,RemoveFilterButton:me,AddFilterButton:V,SaveFilterButton:H}=e,P=le(o),ue=ae(i,P);return n.createElement(ke,{onSubmit:(h,T)=>{let I=se(h);t&&t(I)},initialValues:ue,validationSchema:_(pe),enableReinitialize:!0},n.createElement(qe,null,n.createElement(De,{name:"filters"},h=>{let{form:T,push:I,remove:ce}=h,{filters:de}=T.values,fe=f=>{ce(f),r&&r(f)},Fe=()=>{let[f=null]=P;I({id:f,operator:"",values:[]}),a&&a(h)};return n.createElement("div",{className:"filter-list"},n.createElement("div",{className:"filter-list-labels"},n.createElement("label",null,m),n.createElement("label",null,d),n.createElement("label",null,C),n.createElement("div",{style:{width:36}})),n.createElement("ul",{className:"filter-list__items"},de.map((f,x)=>{let be=()=>{T.setFieldValue(`filters[${x}].operator`,""),T.setFieldValue(`filters[${x}].values`,null)};return n.createElement("li",{className:"filter-list__item",key:x},n.createElement(ie,{loadOptions:p(f?.id?.value),filterType:f?.id?.type,onChangeField:be,options:{fields:P,operators:f?.id?.operators,values:f?.id?.values},onRemove:fe,index:x,RemoveFilterButton:me}))})),n.createElement("div",{className:"button-group"},n.createElement("div",{className:"filter-list-button",onClick:Fe},V?n.createElement(V,null):n.createElement("button",{type:"button",className:"filter-list-button__add"},s)),n.createElement("div",{className:"filter-list-button"},H?n.createElement(H,null):n.createElement("button",{type:"submit",className:"filter-list-button__save"},u))))})))},ne=We;export{ne as TableFiltersClient};
//# sourceMappingURL=index.js.map
