import*as s from"react";import{FieldArray as _e,Form as Se,Formik as Ie}from"formik";import*as n from"yup";var se={required:"Required",date:"Should be valid date format",string:"Should be valid string",number:"Should be valid number"};function I(t=se){let e=n.string().matches(/(0?[1-9]|[12][0-9]|3[01])[- /.](0?[1-9]|1[012])[- /.](19|20)\d\d/,{message:t.date}),l=n.string().matches(/^[0-9]/,{message:t.number});return n.object().shape({filters:n.array().of(n.object().shape({id:n.object().nullable().required(t.required),values:n.lazy((r,o)=>{let i=o&&o.parent&&o.parent.id&&o.parent.id.type?o.parent.id.type:"";return i==="number"?n.array().of(n.object().shape({id:l,name:l})).nullable().required(t.required):i==="date"?n.array().of(n.object().shape({id:e,name:e})).nullable().required(t.required):i==="boolean"?n.boolean():n.array().of(n.object().shape({id:n.string().typeError(t.string),name:n.string().typeError(t.string)})).nullable().required(t.required)}),operator:n.object().nullable().required(t.required)}))})}import*as m from"react";import*as y from"react";var V="number",Y="string",B="boolean",H="date",E="enum",M="source";import*as x from"react";import{Field as ce}from"formik";import*as R from"react";import pe from"classnames";var ue=t=>{let{children:e,label:l="",isError:r,error:o}=t,i=pe("filter-field-control",{isError:r});return R.createElement("div",{className:i},l&&R.createElement("label",null,l),R.createElement("div",{className:"filter-field-control__field"},e),R.createElement("span",{className:"filter-field-control__error"},r&&R.createElement("span",null,o)))},v=ue;import*as q from"react";import{AsyncPaginate as de}from"react-select-async-paginate";var me=t=>{let{...e}=t;return q.createElement(de,{additional:{page:1},...e})},k=me;var fe=t=>{let{name:e,label:l,onChange:r,onBlur:o,...i}=t;return x.createElement(ce,{name:e},c=>{let{field:p,meta:u,form:F}=c,a=u.touched&&!!u.error;return x.createElement(v,{isError:a,error:u.error,label:l},x.createElement(k,{...i,...p,onBlur:f=>{o&&o(f),F.setFieldTouched(e,!0)},onChange:f=>{r&&r(f),F.setFieldValue(e,f)}}))})},D=fe;import*as P from"react";import{Field as Re}from"formik";import*as U from"react";import Fe from"react-select/async-creatable";var be=function(t){let{options:e,isError:l,...r}=t;return U.createElement(Fe,{defaultOptions:e,...r})},j=be;var ve=t=>{let{name:e,label:l,onChange:r,...o}=t;return P.createElement(Re,{name:e},i=>{let{field:c,meta:p,form:u}=i,F=p.touched&&!!p.error;return P.createElement(v,{isError:F,error:p.error,label:l},P.createElement(j,{...o,...c,onBlur:()=>u.setFieldTouched(e,!0),onChange:a=>{r&&r(a),u.setFieldValue(e,a)}}))})},b=ve;import _ from"react";import{Field as ge}from"formik";import N from"react";var ye=t=>{let{isError:e,...l}=t;return N.createElement("label",{className:`field-switch ${e?"isError":""}`},N.createElement("input",{type:"checkbox",className:"field-switch__input",...l}),N.createElement("span",{className:"field-switch__slider field-switch__slider--round"}))},$=ye;var Ce=t=>{let{name:e,label:l,...r}=t;return _.createElement(ge,{name:e},o=>{let{field:i,form:c,meta:p}=o,u=p.touched&&!!p.error;return _.createElement(v,{isError:u,error:p.error,label:l},_.createElement("div",{className:"app-switcher"},_.createElement($,{isError:u,...r,...i,checked:i.value}),i.value?"On":"Off"))})},z=Ce;var he=({type:t,name:e,valueOptions:l,loadOptions:r,classNamePrefix:o,...i})=>{switch(t){case M:return y.createElement(D,{name:e,isMulti:!0,loadOptions:r,classNamePrefix:o,placeholder:"",...i});case B:return y.createElement(z,{name:e,placeholder:""});case(Y||H||E||V):return y.createElement(b,{name:e,isMulti:!0,classNamePrefix:o,placeholder:"",...i});case E:return y.createElement(b,{name:e,options:l,isMulti:!0,classNamePrefix:o,placeholder:"",...i});default:return y.createElement(b,{name:e,isMulti:!0,classNamePrefix:o,placeholder:"",...i})}},W=he;import*as O from"react";import G from"classnames";import*as L from"react";var Te=()=>L.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},L.createElement("path",{d:"M18.222 7.111H15.111V5.556C15.111 5.1435 14.9472 4.74787 14.6556 4.4561C14.364 4.16432 13.9685 4.00027 13.556 4H10.444C10.0315 4.00027 9.63598 4.16432 9.34439 4.4561C9.0528 4.74787 8.889 5.1435 8.889 5.556V7.111H5.778C5.57166 7.111 5.37377 7.19297 5.22787 7.33887C5.08197 7.48477 5 7.68266 5 7.889C5 8.09534 5.08197 8.29323 5.22787 8.43913C5.37377 8.58503 5.57166 8.667 5.778 8.667H6.486L7.461 19.457C7.4827 19.6964 7.59309 19.9191 7.77051 20.0814C7.94793 20.2436 8.17958 20.3337 8.42 20.334H15.507C15.7677 20.3341 16.0189 20.2366 16.2114 20.0608C16.4038 19.885 16.5235 19.6436 16.547 19.384L17.515 8.668H18.223C18.3252 8.66787 18.4263 8.64761 18.5207 8.6084C18.615 8.56918 18.7007 8.51176 18.7728 8.43942C18.845 8.36709 18.9022 8.28125 18.9412 8.1868C18.9801 8.09236 19.0001 7.99117 19 7.889C19 7.68266 18.918 7.48477 18.7721 7.33887C18.6262 7.19297 18.4283 7.111 18.222 7.111ZM10.444 5.556H13.555V7.111H10.444V5.556ZM15.044 18.778H8.96L8.047 8.667H15.952L15.044 18.778Z",fill:"#94A0B5"})),Z=Te;var xe=({className:t="",...e})=>{let l=G("remove-button",G);return O.createElement("button",{...e,className:l,type:"button"},O.createElement(Z,null))},J=xe;var Pe=t=>{let{loadOptions:e,filterType:l,onRemove:r,onChangeField:o,index:i,options:c,RemoveFilterButton:p,fieldId:u}=t;function F(a=[]){return a.map(g=>({name:g,id:g}))}return m.createElement("div",{className:"filter-row"},m.createElement("div",{className:"filter-row__field filter-row__field__id"},m.createElement(b,{classNamePrefix:"select-id",name:`filters[${i}].id`,options:c.fields,getOptionLabel:a=>a.caption,getOptionValue:a=>String(a.id),onChange:o})),m.createElement("div",{className:"filter-row__field filter-row__field__operator"},m.createElement(b,{classNamePrefix:"select-id",name:`filters[${i}].operator`,getOptionLabel:a=>a.name,getOptionValue:a=>String(a.id),options:F(c?.operators),onChange:o})),m.createElement("div",{className:"filter-row__field filter-row__field__values"},m.createElement(W,{classNamePrefix:"select-values",name:`filters[${i}].values`,getOptionLabel:a=>a.name,getOptionValue:a=>String(a.id),getNewOptionData:(a,f)=>({id:f,name:a,__isNew__:!0}),type:l,valueOptions:c.values,loadOptions:e,key:u})),m.createElement("div",{className:"filter-row__field filter-row__remove",onClick:()=>r(i)},p?m.createElement(p,null):m.createElement(J,null)))},K=Pe;var Q=(t,e)=>({filters:t.filters?.length?t.filters.map(r=>({id:e.find(i=>r.id.id===String(i.id)),values:r.values,operator:r.operator||null})):[]}),X=t=>({filters:t.filters.map(l=>{let{id:r,...o}=l;return{...o,id:{caption:r.caption,id:r.id}}})});var Ee=t=>{let{onSubmitFilterForm:e,initialFilters:l,filtersTypesList:r,onRemoveFilter:o,onAddFilter:i,onLoadSourceOptions:c,addFilterButtonText:p,submitFilterButtonText:u,idLabelText:F,operatorLabelText:a,valuesLabelText:f,validationMessages:g,RemoveFilterButton:te,AddFilterButton:A,SaveFilterButton:w}=t,re=Q(l,r);return s.createElement(Ie,{onSubmit:(C,h)=>{let S=X(C);e&&e(S)},initialValues:re,validationSchema:I(g),enableReinitialize:!0},s.createElement(Se,null,s.createElement(_e,{name:"filters"},C=>{let{form:h,push:S,remove:oe}=C,{filters:ie}=h.values,le=d=>{oe(d),o&&o(d)},ae=()=>{let[d=null]=r;S({id:d,operator:null,values:[]}),i&&i(C)};return s.createElement("div",{className:"filter-list"},s.createElement("div",{className:"filter-list-labels"},s.createElement("label",null,F),s.createElement("label",null,a),s.createElement("label",null,f),s.createElement("div",{style:{width:36}})),s.createElement("ul",{className:"filter-list__items"},ie.map((d,T)=>{console.log(d);let ne=()=>{h.setFieldValue(`filters[${T}].operator`,null),h.setFieldValue(`filters[${T}].values`,null)};return s.createElement("li",{className:"filter-list__item",key:T},s.createElement(K,{loadOptions:c(d?.id?.id),fieldId:d?.id?.id,filterType:d?.id?.type,onChangeField:ne,options:{fields:r,operators:d?.id?.operators,values:d?.id?.values},onRemove:le,index:T,RemoveFilterButton:te}))})),s.createElement("div",{className:"button-group"},s.createElement("div",{className:"filter-list-button",onClick:ae},A?s.createElement(A,null):s.createElement("button",{type:"button",className:"filter-list-button__add"},p)),s.createElement("div",{className:"filter-list-button"},w?s.createElement(w,null):s.createElement("button",{type:"submit",className:"filter-list-button__save"},u))))})))},ee=Ee;export{ee as TableFiltersClient};
//# sourceMappingURL=index.js.map
