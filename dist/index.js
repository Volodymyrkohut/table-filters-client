import*as n from"react";import{FieldArray as _e,Form as Ie,Formik as Ee}from"formik";import*as a from"yup";var _=e=>e?.map(t=>t.id),pe={required:"Required",date:"Should be valid date format",string:"Should be valid string",number:"Should be valid number"};function I(e=pe){return a.object().shape({filters:a.array().of(a.object().shape({id:a.object().nullable().required(e.required),values:a.lazy((t,o)=>{let r=o&&o.parent&&o.parent.id&&o.parent.id.type?o.parent.id.type:"";return r==="number"?a.array().transform(i=>_(i)).of(a.number().typeError(e.number)).required(e.required):r==="date"?a.array().transform(i=>_(i)).of(a.date().typeError(e.date)).required(e.required):r==="boolean"?a.boolean():a.array().transform(i=>_(i)).of(a.number().typeError(e.string)).required(e.required)}),operator:a.string().nullable().required(e.required)}))})}import*as m from"react";import*as v from"react";var V="number",B="string",Y="boolean",H="date",E="enum",M="source";import*as x from"react";import{Field as fe}from"formik";import*as b from"react";import ue from"classnames";var me=e=>{let{children:t,label:o="",isError:r,error:i}=e,l=ue("filter-field-control",{isError:r});return b.createElement("div",{className:l},o&&b.createElement("label",null,o),b.createElement("div",{className:"filter-field-control__field"},t),b.createElement("span",{className:"filter-field-control__error"},r&&b.createElement("span",null,i)))},R=me;import*as q from"react";import{AsyncPaginate as ce}from"react-select-async-paginate";var de=e=>{let{...t}=e;return q.createElement(ce,{additional:{page:1},...t})},k=de;var Fe=e=>{let{name:t,label:o,onChange:r,...i}=e;return x.createElement(fe,{name:t},l=>{let{field:c,meta:s,form:u}=l,p=s.touched&&!!s.error;return x.createElement(R,{isError:p,error:s.error,label:o},x.createElement(k,{...i,...c,onBlur:()=>u.setFieldTouched(t,!0),onChange:f=>{r&&r(f),u.setFieldValue(t,f)}}))})},D=Fe;import*as P from"react";import{Field as ve}from"formik";import*as U from"react";import be from"react-select/async-creatable";var Re=function(e){let{options:t,isError:o,...r}=e;return U.createElement(be,{defaultOptions:t,...r})},$=Re;var ye=e=>{let{name:t,label:o,onChange:r,...i}=e;return P.createElement(ve,{name:t},l=>{let{field:c,meta:s,form:u}=l,p=s.touched&&!!s.error;return P.createElement(R,{isError:p,error:s.error,label:o},P.createElement($,{...i,...c,onBlur:()=>u.setFieldTouched(t,!0),onChange:f=>{r&&r(f),u.setFieldValue(t,f)}}))})},F=ye;import S from"react";import{Field as Te}from"formik";import A from"react";var Ce=e=>{let{isError:t,...o}=e;return A.createElement("label",{className:`field-switch ${t?"isError":""}`},A.createElement("input",{type:"checkbox",className:"field-switch__input",...o}),A.createElement("span",{className:"field-switch__slider field-switch__slider--round"}))},j=Ce;var ge=e=>{let{name:t,label:o,...r}=e;return S.createElement(Te,{name:t},i=>{let{field:l,form:c,meta:s}=i,u=s.touched&&!!s.error;return S.createElement(R,{isError:u,error:s.error,label:o},S.createElement("div",{className:"app-switcher"},S.createElement(j,{isError:u,...r,...l,checked:l.value}),l.value?"On":"Off"))})},z=ge;var he=({type:e,name:t,valueOptions:o,loadOptions:r,classNamePrefix:i,...l})=>{switch(e){case M:return v.createElement(D,{name:t,isMulti:!0,loadOptions:r,classNamePrefix:i,placeholder:"",...l});case Y:return v.createElement(z,{name:t,placeholder:""});case(B||H||E||V):return v.createElement(F,{name:t,isMulti:!0,classNamePrefix:i,placeholder:"",...l});case E:return v.createElement(F,{name:t,options:o,isMulti:!0,classNamePrefix:i,placeholder:"",...l});default:return v.createElement(F,{name:t,isMulti:!0,classNamePrefix:i,placeholder:"",...l})}},W=he;import*as L from"react";import G from"classnames";import*as O from"react";var xe=()=>O.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},O.createElement("path",{d:"M18.222 7.111H15.111V5.556C15.111 5.1435 14.9472 4.74787 14.6556 4.4561C14.364 4.16432 13.9685 4.00027 13.556 4H10.444C10.0315 4.00027 9.63598 4.16432 9.34439 4.4561C9.0528 4.74787 8.889 5.1435 8.889 5.556V7.111H5.778C5.57166 7.111 5.37377 7.19297 5.22787 7.33887C5.08197 7.48477 5 7.68266 5 7.889C5 8.09534 5.08197 8.29323 5.22787 8.43913C5.37377 8.58503 5.57166 8.667 5.778 8.667H6.486L7.461 19.457C7.4827 19.6964 7.59309 19.9191 7.77051 20.0814C7.94793 20.2436 8.17958 20.3337 8.42 20.334H15.507C15.7677 20.3341 16.0189 20.2366 16.2114 20.0608C16.4038 19.885 16.5235 19.6436 16.547 19.384L17.515 8.668H18.223C18.3252 8.66787 18.4263 8.64761 18.5207 8.6084C18.615 8.56918 18.7007 8.51176 18.7728 8.43942C18.845 8.36709 18.9022 8.28125 18.9412 8.1868C18.9801 8.09236 19.0001 7.99117 19 7.889C19 7.68266 18.918 7.48477 18.7721 7.33887C18.6262 7.19297 18.4283 7.111 18.222 7.111ZM10.444 5.556H13.555V7.111H10.444V5.556ZM15.044 18.778H8.96L8.047 8.667H15.952L15.044 18.778Z",fill:"#94A0B5"})),Z=xe;var Pe=({className:e="",...t})=>{let o=G("remove-button",G);return L.createElement("button",{...t,className:o,type:"button"},L.createElement(Z,null))},J=Pe;var Se=e=>{let{loadOptions:t,filterType:o,onRemove:r,onChangeField:i,index:l,options:c,RemoveFilterButton:s}=e;function u(p=[]){return p.map(y=>({label:y,value:y}))}return m.createElement("div",{className:"filter-row"},m.createElement("div",{className:"filter-row__field filter-row__field__id"},m.createElement(F,{classNamePrefix:"select-id",name:`filters[${l}].id`,options:c.fields,getOptionLabel:p=>p.caption,getOptionValue:p=>String(p.id),onChange:i})),m.createElement("div",{className:"filter-row__field filter-row__field__operator"},m.createElement(F,{classNamePrefix:"select-id",name:`filters[${l}].operator`,options:u(c?.operators),onChange:i})),m.createElement("div",{className:"filter-row__field filter-row__field__values"},m.createElement(W,{classNamePrefix:"select-values",name:`filters[${l}].values`,getOptionLabel:p=>p.name,getOptionValue:p=>String(p.id),type:o,valueOptions:c.values,loadOptions:t})),m.createElement("div",{className:"filter-row__field filter-row__remove",onClick:()=>r(l)},s?m.createElement(s,null):m.createElement(J,null)))},K=Se;var Q=(e,t)=>({filters:e.filters?.length?e.filters.map(r=>({id:t.find(l=>r.id.id===String(l.id)),values:r.values,operator:r.operator})):[]}),X=e=>({filters:e.filters.map(o=>{let{id:r,...i}=o;return{...i,id:{caption:r.caption,id:r.id}}})});var Ae=e=>{let{onSubmitFilterForm:t,initialFilters:o,filtersTypesList:r,onRemoveFilter:i,onAddFilter:l,onLoadSourceOptions:c,addFilterButtonText:s,submitFilterButtonText:u,idLabelText:p,operatorLabelText:f,valuesLabelText:y,validationMessages:te,RemoveFilterButton:re,AddFilterButton:N,SaveFilterButton:w}=e,oe=Q(o,r);return n.createElement(Ee,{onSubmit:(C,T)=>{let g=X(C);console.log(g),t&&t(g)},initialValues:oe,validationSchema:I(te),enableReinitialize:!0},n.createElement(Ie,null,n.createElement(_e,{name:"filters"},C=>{let{form:T,push:g,remove:ie}=C,{filters:le}=T.values,ae=d=>{ie(d),i&&i(d)},ne=()=>{let[d=null]=r;g({id:d,operator:"",values:[]}),l&&l(C)};return n.createElement("div",{className:"filter-list"},n.createElement("div",{className:"filter-list-labels"},n.createElement("label",null,p),n.createElement("label",null,f),n.createElement("label",null,y),n.createElement("div",{style:{width:36}})),n.createElement("ul",{className:"filter-list__items"},le.map((d,h)=>{let se=()=>{T.setFieldValue(`filters[${h}].operator`,""),T.setFieldValue(`filters[${h}].values`,null)};return n.createElement("li",{className:"filter-list__item",key:h},n.createElement(K,{loadOptions:c(d?.id?.id),filterType:d?.id?.type,onChangeField:se,options:{fields:r,operators:d?.id?.operators,values:d?.id?.values},onRemove:ae,index:h,RemoveFilterButton:re}))})),n.createElement("div",{className:"button-group"},n.createElement("div",{className:"filter-list-button",onClick:ne},N?n.createElement(N,null):n.createElement("button",{type:"button",className:"filter-list-button__add"},s)),n.createElement("div",{className:"filter-list-button"},w?n.createElement(w,null):n.createElement("button",{type:"submit",className:"filter-list-button__save"},u))))})))},ee=Ae;export{ee as TableFiltersClient};
//# sourceMappingURL=index.js.map
