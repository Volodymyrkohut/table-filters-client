import*as s from"react";import{FieldArray as Se,Form as Ie,Formik as Ee}from"formik";import*as n from"yup";var se={required:"This field is required ",date:"Should be valid date format ",string:"Should be valid string ",number:"Should be valid number "};function I(e=se){let t=n.string().matches(/(0?[1-9]|[12][0-9]|3[01])[- /.](0?[1-9]|1[012])[- /.](19|20)\d\d/,{message:e.date}),r=n.string().matches(/^[0-9]/,{message:e.number,excludeEmptyString:!0});return n.object().shape({filters:n.array().of(n.object().shape({id:n.object().nullable().required(e.required),values:n.lazy((o,i)=>{let l=i&&i.parent&&i.parent.id&&i.parent.id.type?i.parent.id.type:"";return l==="number"?n.array().nullable().of(n.object().shape({id:r,name:r})).min(1,e.required).nullable().required(e.required):l==="date"?n.array().of(n.object().shape({id:t,name:t})).min(1,e.required).nullable().required(e.required):l==="boolean"?n.boolean():n.array().of(n.object().shape({id:n.string().typeError(e.string),name:n.string().typeError(e.string)})).min(1,e.required).nullable().required(e.required)}),operator:n.object().nullable().required(e.required)}))})}import*as m from"react";import*as g from"react";var V="number",Y="string",B="boolean",H="date",E="enum",q="source";import*as x from"react";import{Field as ce}from"formik";import*as y from"react";import pe from"classnames";var ue=e=>{let{children:t,label:r="",isError:o,error:i}=e,l=pe("filter-field-control",{isError:o});return y.createElement("div",{className:l},r&&y.createElement("label",null,r),y.createElement("div",{className:"filter-field-control__field"},t),y.createElement("span",{className:"filter-field-control__error"},o&&y.createElement("span",null,i)))},R=ue;import*as M from"react";import{AsyncPaginate as de}from"react-select-async-paginate";var me=e=>{let{...t}=e;return M.createElement(de,{additional:{page:1},...t})},k=me;var fe=e=>{let{name:t,label:r,onChange:o,onBlur:i,...l}=e;return x.createElement(ce,{name:t},c=>{let{field:p,meta:u,form:F}=c,a=u.touched&&!!u.error;return x.createElement(R,{isError:a,error:u.error,label:r},x.createElement(k,{...l,...p,onBlur:f=>{i&&i(f),F.setFieldTouched(t,!0)},onChange:f=>{o&&o(f),F.setFieldValue(t,f)}}))})},D=fe;import*as P from"react";import{Field as ye}from"formik";import*as U from"react";import Fe from"react-select/async-creatable";var be=function(e){let{options:t,isError:r,...o}=e;return U.createElement(Fe,{defaultOptions:t,...o})},j=be;var Re=e=>{if(typeof e=="string")return e;if(Array.isArray(e)){let t=e.filter(r=>r&&r.id);if(t[0]&&t[0].id)return t[0].id}else return""},ge=e=>{let{name:t,label:r,onChange:o,...i}=e;return P.createElement(ye,{name:t},l=>{let{field:c,meta:p,form:u}=l,F=p.touched&&!!p.error;return console.log(p.error),P.createElement(R,{isError:F,error:Re(p.error),label:r},P.createElement(j,{...i,...c,onBlur:()=>u.setFieldTouched(t,!0),onChange:a=>{o&&o(a),u.setFieldValue(t,a)}}))})},b=ge;import _ from"react";import{Field as Ce}from"formik";import N from"react";var ve=e=>{let{isError:t,...r}=e;return N.createElement("label",{className:`field-switch ${t?"isError":""}`},N.createElement("input",{type:"checkbox",className:"field-switch__input",...r}),N.createElement("span",{className:"field-switch__slider field-switch__slider--round"}))},$=ve;var he=e=>{let{name:t,label:r,...o}=e;return _.createElement(Ce,{name:t},i=>{let{field:l,form:c,meta:p}=i,u=p.touched&&!!p.error;return _.createElement(R,{isError:u,error:p.error,label:r},_.createElement("div",{className:"app-switcher"},_.createElement($,{isError:u,...o,...l,checked:l.value}),l.value?"On":"Off"))})},z=he;var Te=({type:e,name:t,valueOptions:r,loadOptions:o,classNamePrefix:i,...l})=>{switch(e){case q:return g.createElement(D,{name:t,isMulti:!0,loadOptions:o,classNamePrefix:i,placeholder:"",...l});case B:return g.createElement(z,{name:t,placeholder:""});case(Y||H||E||V):return g.createElement(b,{name:t,isMulti:!0,classNamePrefix:i,placeholder:"",...l});case E:return g.createElement(b,{name:t,options:r,isMulti:!0,classNamePrefix:i,placeholder:"",...l});default:return g.createElement(b,{name:t,isMulti:!0,classNamePrefix:i,placeholder:"",...l})}},W=Te;import*as L from"react";import G from"classnames";import*as A from"react";var xe=()=>A.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},A.createElement("path",{d:"M18.222 7.111H15.111V5.556C15.111 5.1435 14.9472 4.74787 14.6556 4.4561C14.364 4.16432 13.9685 4.00027 13.556 4H10.444C10.0315 4.00027 9.63598 4.16432 9.34439 4.4561C9.0528 4.74787 8.889 5.1435 8.889 5.556V7.111H5.778C5.57166 7.111 5.37377 7.19297 5.22787 7.33887C5.08197 7.48477 5 7.68266 5 7.889C5 8.09534 5.08197 8.29323 5.22787 8.43913C5.37377 8.58503 5.57166 8.667 5.778 8.667H6.486L7.461 19.457C7.4827 19.6964 7.59309 19.9191 7.77051 20.0814C7.94793 20.2436 8.17958 20.3337 8.42 20.334H15.507C15.7677 20.3341 16.0189 20.2366 16.2114 20.0608C16.4038 19.885 16.5235 19.6436 16.547 19.384L17.515 8.668H18.223C18.3252 8.66787 18.4263 8.64761 18.5207 8.6084C18.615 8.56918 18.7007 8.51176 18.7728 8.43942C18.845 8.36709 18.9022 8.28125 18.9412 8.1868C18.9801 8.09236 19.0001 7.99117 19 7.889C19 7.68266 18.918 7.48477 18.7721 7.33887C18.6262 7.19297 18.4283 7.111 18.222 7.111ZM10.444 5.556H13.555V7.111H10.444V5.556ZM15.044 18.778H8.96L8.047 8.667H15.952L15.044 18.778Z",fill:"#94A0B5"})),Z=xe;var Pe=({className:e="",...t})=>{let r=G("remove-button",G);return L.createElement("button",{...t,className:r,type:"button"},L.createElement(Z,null))},J=Pe;var _e=e=>{let{loadOptions:t,filterType:r,onRemove:o,onChangeField:i,index:l,options:c,RemoveFilterButton:p,fieldId:u}=e;function F(a=[]){return a.map(v=>({name:v,id:v}))}return m.createElement("div",{className:"filter-row"},m.createElement("div",{className:"filter-row__field filter-row__field__id"},m.createElement(b,{classNamePrefix:"select-id",name:`filters[${l}].id`,options:c.fields,getOptionLabel:a=>a.caption,getOptionValue:a=>String(a.id),onChange:i})),m.createElement("div",{className:"filter-row__field filter-row__field__operator"},m.createElement(b,{classNamePrefix:"select-id",name:`filters[${l}].operator`,getOptionLabel:a=>a.name,getOptionValue:a=>String(a.id),options:F(c?.operators),onChange:i})),m.createElement("div",{className:"filter-row__field filter-row__field__values"},m.createElement(W,{classNamePrefix:"select-values",name:`filters[${l}].values`,getOptionLabel:a=>a.name,getOptionValue:a=>String(a.id),getNewOptionData:(a,f)=>({id:f,name:a,__isNew__:!0}),type:r,valueOptions:c.values,loadOptions:t,key:u})),m.createElement("div",{className:"filter-row__field filter-row__remove",onClick:()=>o(l)},p?m.createElement(p,null):m.createElement(J,null)))},K=_e;var Q=(e,t)=>({filters:e.filters?.length?e.filters.map(o=>({id:t.find(l=>o.id.id===String(l.id)),values:o.values,operator:o.operator||null})):[]}),X=e=>({filters:e.filters.map(r=>{let{id:o,...i}=r;return{...i,id:{caption:o.caption,id:o.id}}})});var Ne=e=>{let{onSubmitFilterForm:t,initialFilters:r,filtersTypesList:o,onRemoveFilter:i,onAddFilter:l,onLoadSourceOptions:c,addFilterButtonText:p,submitFilterButtonText:u,idLabelText:F,operatorLabelText:a,valuesLabelText:f,validationMessages:v,RemoveFilterButton:te,AddFilterButton:O,SaveFilterButton:w}=e,re=Q(r,o);return s.createElement(Ee,{onSubmit:(C,h)=>{let S=X(C);t&&t(S)},initialValues:re,validationSchema:I(v),enableReinitialize:!0},s.createElement(Ie,null,s.createElement(Se,{name:"filters"},C=>{let{form:h,push:S,remove:oe}=C,{filters:ie}=h.values,le=d=>{oe(d),i&&i(d)},ae=()=>{let[d=null]=o;S({id:d,operator:null,values:[]}),l&&l(C)};return s.createElement("div",{className:"filter-list"},s.createElement("div",{className:"filter-list-labels"},s.createElement("label",null,F),s.createElement("label",null,a),s.createElement("label",null,f),s.createElement("div",{style:{width:36}})),s.createElement("ul",{className:"filter-list__items"},ie.map((d,T)=>{console.log(d);let ne=()=>{h.setFieldValue(`filters[${T}].operator`,null),h.setFieldValue(`filters[${T}].values`,null)};return s.createElement("li",{className:"filter-list__item",key:T},s.createElement(K,{loadOptions:c(d?.id?.id),fieldId:d?.id?.id,filterType:d?.id?.type,onChangeField:ne,options:{fields:o,operators:d?.id?.operators,values:d?.id?.values?.data},onRemove:le,index:T,RemoveFilterButton:te}))})),s.createElement("div",{className:"button-group"},s.createElement("div",{className:"filter-list-button",onClick:ae},O?s.createElement(O,null):s.createElement("button",{type:"button",className:"filter-list-button__add"},p)),s.createElement("div",{className:"filter-list-button"},w?s.createElement(w,null):s.createElement("button",{type:"submit",className:"filter-list-button__save"},u))))})))},ee=Ne;export{ee as TableFiltersClient};
//# sourceMappingURL=index.js.map
