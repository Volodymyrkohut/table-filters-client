"use strict";var B=Object.create;var S=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,Q=Object.prototype.hasOwnProperty;var X=(e,t)=>{for(var r in t)S(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of J(t))!Q.call(e,o)&&o!==r&&S(e,o,{get:()=>t[o],enumerable:!(i=G(t,o))||i.enumerable});return e};var p=(e,t,r)=>(r=e!=null?B(K(e)):{},w(t||!e||!e.__esModule?S(r,"default",{value:e,enumerable:!0}):r,e)),Z=e=>w(S({},"__esModule",{value:!0}),e);var ne={};X(ne,{TableFiltersClient:()=>L});module.exports=Z(ne);var c=p(require("react"));var v=require("formik");var n=p(require("yup")),ee=n.object().shape({filters:n.array().of(n.object().shape({id:n.object().shape({label:n.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),value:n.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F")}).nullable().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),values:n.array().of(n.object().shape({label:n.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),value:n.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F")})).nullable().min(1,"\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F").required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),operator:n.string().nullable().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F")}))}),E=ee;var d=p(require("react"));var h=p(require("react")),M=require("formik");var b=p(require("react")),V=p(require("react-select/async")),O=p(require("react-select")),k=p(require("react-select/async-creatable")),te=function(e){let{type:t="default",options:r,isError:i,...o}=e,a=l=>l.inputValue===""?null:"\u0420\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0456\u0432 \u043D\u0435 \u0437\u043D\u0430\u0439\u0434\u0435\u043D\u043E";switch(t){case"async":return b.createElement(V.default,{defaultOptions:r,noOptionsMessage:a,...o});case"creatable":return b.createElement(k.default,{defaultOptions:r,...o});case"default":return b.createElement(O.default,{options:r,...o});default:return b.createElement(O.default,{options:r,...o})}},Y=te;var y=p(require("react"));var D=p(require("classnames")),re=e=>{let{children:t,label:r="",isError:i,error:o}=e,a=(0,D.default)("field-control",{isError:i});return y.createElement("div",{className:a},r&&y.createElement("label",null,r),t,y.createElement("span",{className:"field-control__error"},i&&y.createElement("span",null,o)))},_=re;var oe=e=>{let{name:t,label:r,onChange:i,...o}=e;return h.createElement(M.Field,{name:t},a=>{let{field:l,meta:m,form:f}=a,s=m.touched&&!!m.error;return h.createElement(_,{isError:s,error:m.error,label:r},h.createElement(Y,{...o,...l,onBlur:()=>f.setFieldTouched(t,!0),onChange:u=>{i&&i(u),f.setFieldValue(t,u)}}))})},T=oe;var I=p(require("react")),U=require("formik");var P=p(require("react")),q=p(require("classnames")),ie=e=>{let{isError:t,children:r,...i}=e,o=(0,q.default)("select",{isError:t});return P.default.createElement("div",{className:o},P.default.createElement("select",{autoComplete:"off",...i},r))},H=ie;var ae=e=>{let{name:t,options:r=[],disabled:i,label:o,id:a}=e;return I.default.createElement(U.Field,{name:t},l=>{let{field:m,meta:f}=l,s=f.touched&&!!f.error;return I.default.createElement(_,{isError:s,error:f.error,label:o},I.default.createElement(H,{id:a,...m,isError:s,disabled:i},r.map(u=>I.default.createElement("option",{key:u.value,value:u.value},u.key))))})},$=ae;var le=e=>{let{idOptions:t,operatorOptions:r,valueOptions:i,onRemove:o,onChangeIdSelect:a,index:l}=e;return d.createElement("div",{className:"filter-row"},d.createElement("div",{className:"filter-row__field filter-row__field__id"},d.createElement(T,{name:`filters[${l}].id`,options:t,onChange:a})),d.createElement("div",{className:"filter-row__field filter-row__field__operator"},d.createElement($,{name:`filters[${l}].operator`,options:r})),d.createElement("div",{className:"filter-row__field filter-row__field__values"},d.createElement(T,{name:`filters[${l}].values`,options:i,isMulti:!0,type:"creatable"})),d.createElement("div",{className:"filter-row__field filter-row__remove"},d.createElement("button",{type:"button",onClick:()=>o(l)},"\u0432\u0438\u0434\u0430\u043B\u0438\u0442\u0438")))},j=le;var z=(e,t)=>({filters:e.filters?.length?e.filters.map(i=>{let o=t.find(a=>i.id.value===a.value);return{values:i.values,operator:i.operator,id:o}}):[]}),W=e=>e.map(t=>{let{caption:r,id:i,values:o,operators:a,...l}=t,m;Array.isArray(o)?m=o.map(s=>({label:s.name,value:String(s.id)})):m=o;let f=a.map(s=>({key:s,value:s}));return{label:r,value:String(i),values:m,operators:[{key:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440",value:""},...f],...l}});var se=e=>{let{onSubmitFilterForm:t,initialFilters:r,filtersTypesList:i,onRemoveFilter:o,onAddFilter:a}=e,l=W(i),m=z(r,l);return c.createElement(v.Formik,{onSubmit:(s,u)=>{let g={filters:s.filters.map(A=>{let{id:R,...x}=A;return{...x,id:{label:R.label,value:R.value}}})};t&&t(g)},initialValues:m,validationSchema:E,enableReinitialize:!0},c.createElement(v.Form,null,c.createElement(v.FieldArray,{name:"filters"},s=>{let{form:u,push:N,remove:g}=s,{filters:A}=u.values,R=F=>{g(F),o&&o(F)},x=()=>{let[F=null]=l;N({id:F,operator:"",values:[]}),a&&a(s)};return c.createElement("div",{className:"filter-list"},c.createElement("ul",{className:"filter-list__items"},A.map((F,C)=>c.createElement("li",{className:"filter-list__item",key:C},c.createElement(j,{onChangeIdSelect:me=>{u.setFieldValue(`filters[${C}].operator`,""),u.setFieldValue(`filters[${C}].values`,null)},idOptions:l,operatorOptions:F?.id?.operators,valueOptions:F?.id?.values,onRemove:R,index:C})))),c.createElement("div",{className:"filter-list__button"},c.createElement("button",{type:"button",onClick:x},"add one more filter")))}),c.createElement("button",{type:"submit"},"\u0417\u0430\u0441\u0442\u0443\u0441\u0443\u0432\u0430\u0442\u0438 \u0444\u0456\u043B\u044C\u0442\u0440")))},L=se;
//# sourceMappingURL=index.js.map
