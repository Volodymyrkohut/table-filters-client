"use strict";var le=Object.create;var O=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var pe=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty;var ce=(t,e)=>{for(var r in e)O(t,r,{get:e[r],enumerable:!0})},w=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of se(e))!me.call(t,i)&&i!==r&&O(t,i,{get:()=>e[i],enumerable:!(o=ne(e,i))||o.enumerable});return t};var c=(t,e,r)=>(r=t!=null?le(pe(t)):{},w(e||!t||!t.__esModule?O(r,"default",{value:t,enumerable:!0}):r,t)),de=t=>w(O({},"__esModule",{value:!0}),t);var ge={};ce(ge,{TableFiltersClient:()=>N});module.exports=de(ge);var u=c(require("react"));var b=require("formik");var p=c(require("yup")),ue=p.object().shape({filters:p.array().of(p.object().shape({id:p.object().shape({label:p.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),value:p.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F")}).nullable().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),values:p.array().of(p.object().shape({label:p.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),value:p.string().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F")})).nullable().min(1,"\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F").required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F"),operator:p.string().nullable().required("\u0426\u0435 \u043F\u043E\u043B\u0435 \u0454 \u043E\u0431\u043E\u0432\u044F\u0437\u043A\u043E\u0432\u0438\u043C \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F")}))}),V=ue;var f=c(require("react"));var T=c(require("react")),q=require("formik");var M=c(require("react")),k=c(require("react-select/async-creatable")),fe=function(t){let{options:e,isError:r,...o}=t;return M.createElement(k.default,{defaultOptions:e,...o})},D=fe;var I=c(require("react"));var U=c(require("classnames")),Fe=t=>{let{children:e,label:r="",isError:o,error:i}=t,n=(0,U.default)("field-control",{isError:o});return I.createElement("div",{className:n},r&&I.createElement("label",null,r),e,I.createElement("span",{className:"field-control__error"},o&&I.createElement("span",null,i)))},y=Fe;var ye=t=>{let{name:e,label:r,onChange:o,...i}=t;return T.createElement(q.Field,{name:e},n=>{let{field:d,meta:a,form:l}=n,m=a.touched&&!!a.error;return T.createElement(y,{isError:m,error:a.error,label:r},T.createElement(D,{...i,...d,onBlur:()=>l.setFieldTouched(e,!0),onChange:s=>{o&&o(s),l.setFieldValue(e,s)}}))})},v=ye;var C=c(require("react")),$=require("formik");var h=c(require("react")),H=c(require("classnames")),ve=t=>{let{isError:e,children:r,...o}=t,i=(0,H.default)("select",{isError:e});return h.default.createElement("div",{className:i},h.default.createElement("select",{autoComplete:"off",...o},r))},B=ve;var be=t=>{let{name:e,options:r=[],disabled:o,label:i,id:n}=t;return C.default.createElement($.Field,{name:e},d=>{let{field:a,meta:l}=d,m=l.touched&&!!l.error;return C.default.createElement(y,{isError:m,error:l.error,label:i},C.default.createElement(B,{id:n,...a,isError:m,disabled:o},r.map(s=>C.default.createElement("option",{key:s.value,value:s.value},s.key))))})},j=be;var S=c(require("react"));var z="number",G="string",W="boolean",J="date",L="enum",K="source";var A=c(require("react")),Z=require("formik");var Q=require("react-select-async-paginate"),Ie=t=>{let{...e}=t;return React.createElement(Q.AsyncPaginate,{additional:{page:1},...e})},X=Ie;var Ce=t=>{let{name:e,label:r,onChange:o,...i}=t;return A.createElement(Z.Field,{name:e},n=>{let{field:d,meta:a,form:l}=n,m=a.touched&&!!a.error;return A.createElement(y,{isError:m,error:a.error,label:r},A.createElement(X,{...i,...d,onBlur:()=>l.setFieldTouched(e,!0),onChange:s=>{o&&o(s),l.setFieldValue(e,s)}}))})},ee=Ce;var Se=({type:t,name:e,valueOptions:r,loadOptions:o})=>{switch(t){case K:return S.default.createElement(ee,{name:e,isMulti:!0,loadOptions:o});case(G||W||J||L||z):return S.default.createElement(v,{name:e,isMulti:!0});case L:return S.default.createElement(v,{name:e,options:r,isMulti:!0});default:return S.default.createElement(v,{name:e,isMulti:!0})}},te=Se;var Re=t=>{let{idOptions:e,loadOptions:r,operatorOptions:o,type:i,valueOptions:n,onRemove:d,onChangeIdSelect:a,index:l}=t;return f.createElement("div",{className:"filter-row"},f.createElement("div",{className:"filter-row__field filter-row__field__id"},f.createElement(v,{name:`filters[${l}].id`,options:e,onChange:a})),f.createElement("div",{className:"filter-row__field filter-row__field__operator"},f.createElement(j,{name:`filters[${l}].operator`,options:o})),f.createElement("div",{className:"filter-row__field filter-row__field__values"},f.createElement(te,{name:`filters[${l}].values`,type:i,valueOptions:n,loadOptions:r}),i),f.createElement("div",{className:"filter-row__field filter-row__remove"},f.createElement("button",{type:"button",onClick:()=>d(l)},"\u0432\u0438\u0434\u0430\u043B\u0438\u0442\u0438")))},re=Re;var oe=(t,e)=>({filters:t.filters?.length?t.filters.map(o=>{let i=e.find(n=>o.id.value===n.value);return{values:o.values,operator:o.operator,id:i}}):[]}),ie=t=>t.map(e=>{let{caption:r,id:o,values:i,operators:n,...d}=e,a;Array.isArray(i)?a=i.map(m=>({label:m.name,value:String(m.id)})):a=i;let l=n.map(m=>({key:m,value:m}));return{label:r,value:String(o),values:a,operators:[{key:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440",value:""},...l],...d}});var Pe=t=>{let{onSubmitFilterForm:e,initialFilters:r,filtersTypesList:o,onRemoveFilter:i,onAddFilter:n,onLoadSourceOptions:d}=t,a=ie(o),l=oe(r,a);return u.createElement(b.Formik,{onSubmit:(s,R)=>{let _={filters:s.filters.map(E=>{let{id:P,...x}=E;return{...x,id:{label:P.label,value:P.value}}})};e&&e(_)},initialValues:l,validationSchema:V,enableReinitialize:!0},u.createElement(b.Form,null,u.createElement(b.FieldArray,{name:"filters"},s=>{let{form:R,push:Y,remove:_}=s,{filters:E}=R.values,P=F=>{_(F),i&&i(F)},x=()=>{let[F=null]=a;Y({id:F,operator:"",values:[]}),n&&n(s)};return u.createElement("div",{className:"filter-list"},u.createElement("ul",{className:"filter-list__items"},E.map((F,g)=>{let ae=Oe=>{R.setFieldValue(`filters[${g}].operator`,""),R.setFieldValue(`filters[${g}].values`,null)};return u.createElement("li",{className:"filter-list__item",key:g},u.createElement(re,{loadOptions:d(F?.id?.value),type:F?.id?.type,onChangeIdSelect:ae,idOptions:a,operatorOptions:F?.id?.operators,valueOptions:F?.id?.values,onRemove:P,index:g}))})),u.createElement("div",{className:"filter-list__button"},u.createElement("button",{type:"button",onClick:x},"add one more filter")))}),u.createElement("button",{type:"submit"},"\u0417\u0430\u0441\u0442\u0443\u0441\u0443\u0432\u0430\u0442\u0438 \u0444\u0456\u043B\u044C\u0442\u0440")))},N=Pe;
//# sourceMappingURL=index.js.map
