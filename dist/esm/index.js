import*as p from"react";import{FieldArray as Ne,Form as Le,Formik as Ee}from"formik";import*as a from"yup";var B=e=>e?.map(t=>t.value),F={required:"Required",date:"Should be valid date format",string:"Should be valid string",number:"Should be valid number"},me=a.object().shape({filters:a.array().of(a.object().shape({id:a.object().shape({label:a.string().required(),value:a.string().required(),type:a.string().required()}).nullable().required(F.required),values:a.array().when("id",{is:e=>e.type==="number",then:a.array().transform(e=>B(e)).of(a.number().typeError(F.number)).required(F.required)}).when("id",{is:e=>e.type==="date",then:a.array().transform(e=>B(e)).of(a.date().typeError(F.date)).required(F.required)}).when("id",{is:e=>e.type!=="date"&&e.type!=="number",then:a.array().transform(e=>B(e)).of(a.number().typeError(F.string)).required(F.required)}),operator:a.string().nullable().required(F.required)}))}),w=me;import*as u from"react";import*as g from"react";var P="number",A="string",z="boolean",Y="date",I="enum",D="source";import*as h from"react";import{Field as Re}from"formik";import*as b from"react";import fe from"classnames";import*as Q from"react";var ue=()=>Q.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q.createElement("rect",{width:"16",height:"16",fill:"white",fillOpacity:"0.01"}),Q.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5109 2.65516C8.67288 2.72228 8.82004 2.82065 8.94399 2.94466L13.056 7.05599C13.1801 7.17995 13.2786 7.32716 13.3457 7.48919C13.4129 7.65123 13.4475 7.82492 13.4475 8.00033C13.4475 8.17574 13.4129 8.34943 13.3457 8.51146C13.2786 8.6735 13.1801 8.8207 13.056 8.94466L8.94399 13.056C8.82004 13.18 8.67288 13.2784 8.5109 13.3455C8.34893 13.4126 8.17532 13.4472 7.99999 13.4472C7.82466 13.4472 7.65104 13.4126 7.48907 13.3455C7.3271 13.2784 7.17993 13.18 7.05599 13.056L2.94399 8.94466C2.81988 8.8207 2.72142 8.6735 2.65424 8.51146C2.58707 8.34943 2.55249 8.17574 2.55249 8.00033C2.55249 7.82492 2.58707 7.65123 2.65424 7.48919C2.72142 7.32716 2.81988 7.17995 2.94399 7.05599L7.05599 2.94466C7.17993 2.82065 7.3271 2.72228 7.48907 2.65516C7.65104 2.58804 7.82466 2.5535 7.99999 2.5535C8.17532 2.5535 8.34893 2.58804 8.5109 2.65516ZM7.52858 9.13806C7.6536 9.26308 7.82317 9.33332 7.99998 9.33332C8.1768 9.33332 8.34636 9.26308 8.47139 9.13806C8.59641 9.01304 8.66665 8.84347 8.66665 8.66666V5.33332C8.66665 5.15651 8.59641 4.98694 8.47139 4.86192C8.34636 4.73689 8.1768 4.66666 7.99998 4.66666C7.82317 4.66666 7.6536 4.73689 7.52858 4.86192C7.40356 4.98694 7.33332 5.15651 7.33332 5.33332V8.66666C7.33332 8.84347 7.40356 9.01304 7.52858 9.13806ZM7.52858 11.1381C7.6536 11.2631 7.82317 11.3333 7.99998 11.3333C8.1768 11.3333 8.34636 11.2631 8.47139 11.1381C8.59641 11.013 8.66665 10.8435 8.66665 10.6667C8.66665 10.4898 8.59641 10.3203 8.47139 10.1953C8.34636 10.0702 8.1768 9.99999 7.99998 9.99999C7.82317 9.99999 7.6536 10.0702 7.52858 10.1953C7.40356 10.3203 7.33332 10.4898 7.33332 10.6667C7.33332 10.8435 7.40356 11.013 7.52858 11.1381Z",fill:"#DE350B"})),Z=ue;var Fe=e=>{let{children:t,label:i="",isError:r,error:o}=e,l=fe("field-control",{isError:r});return b.createElement("div",{className:l},i&&b.createElement("label",null,i),b.createElement("div",{className:"field-control__field"},t),b.createElement("span",{className:"field-control__error"},r&&b.createElement("span",null,b.createElement(Z,null),o)))},v=Fe;import*as j from"react";import{AsyncPaginate as be}from"react-select-async-paginate";var ve=e=>{let{...t}=e;return j.createElement(be,{additional:{page:1},...t})},M=ve;var ye=e=>{let{name:t,label:i,onChange:r,...o}=e;return h.createElement(Re,{name:t},l=>{let{field:d,meta:s,form:n}=l,c=s.touched&&!!s.error;return h.createElement(v,{isError:c,error:s.error,label:i},h.createElement(M,{...o,...d,onBlur:()=>n.setFieldTouched(t,!0),onChange:m=>{r&&r(m),n.setFieldValue(t,m)}}))})},W=ye;import*as O from"react";import{Field as _e}from"formik";import*as G from"react";import ge from"react-select/async-creatable";var Ce=function(e){let{options:t,isError:i,...r}=e;return G.createElement(ge,{defaultOptions:t,...r})},H=Ce;var Ue=e=>{let{name:t,label:i,onChange:r,...o}=e;return O.createElement(_e,{name:t},l=>{let{field:d,meta:s,form:n}=l,c=s.touched&&!!s.error;return O.createElement(v,{isError:c,error:s.error,label:i},O.createElement(H,{...o,...d,onBlur:()=>n.setFieldTouched(t,!0),onChange:m=>{r&&r(m),n.setFieldValue(t,m)}}))})},R=Ue;var xe=({type:e,name:t,valueOptions:i,loadOptions:r,classNamePrefix:o})=>{switch(e){case D:return g.createElement(W,{name:t,isMulti:!0,loadOptions:r,classNamePrefix:o});case(A||z||Y||I||P):return g.createElement(R,{name:t,isMulti:!0,classNamePrefix:o});case I:return g.createElement(R,{name:t,options:i,isMulti:!0,classNamePrefix:o});default:return g.createElement(R,{name:t,isMulti:!0,classNamePrefix:o})}},J=xe;import*as C from"react";import{Field as Te}from"formik";import N from"react";import he from"classnames";import*as S from"react";var Qe=()=>S.createElement("svg",{height:"20",width:"20",viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",className:"css-tj5bde-Svg"},S.createElement("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"})),k=Qe;var Oe=e=>{let{isError:t,children:i,className:r,...o}=e,l=he("field-select",r,{isError:t});return N.createElement("div",{className:l},N.createElement("select",{autoComplete:"off",...o},i),N.createElement(k,null))},X=Oe;var Ve=e=>{let{name:t,options:i=[],disabled:r,label:o,id:l,className:d}=e;return C.createElement(Te,{name:t},s=>{let{field:n,meta:c}=s,m=c.touched&&!!c.error;return C.createElement(v,{isError:m,error:c.error,label:o},C.createElement(X,{id:l,...n,isError:m,disabled:r,className:d},i.map(y=>C.createElement("option",{key:y.value,value:y.value},y.key))))})},q=Ve;import*as E from"react";import K from"classnames";import*as L from"react";var Be=()=>L.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},L.createElement("path",{d:"M18.222 7.111H15.111V5.556C15.111 5.1435 14.9472 4.74787 14.6556 4.4561C14.364 4.16432 13.9685 4.00027 13.556 4H10.444C10.0315 4.00027 9.63598 4.16432 9.34439 4.4561C9.0528 4.74787 8.889 5.1435 8.889 5.556V7.111H5.778C5.57166 7.111 5.37377 7.19297 5.22787 7.33887C5.08197 7.48477 5 7.68266 5 7.889C5 8.09534 5.08197 8.29323 5.22787 8.43913C5.37377 8.58503 5.57166 8.667 5.778 8.667H6.486L7.461 19.457C7.4827 19.6964 7.59309 19.9191 7.77051 20.0814C7.94793 20.2436 8.17958 20.3337 8.42 20.334H15.507C15.7677 20.3341 16.0189 20.2366 16.2114 20.0608C16.4038 19.885 16.5235 19.6436 16.547 19.384L17.515 8.668H18.223C18.3252 8.66787 18.4263 8.64761 18.5207 8.6084C18.615 8.56918 18.7007 8.51176 18.7728 8.43942C18.845 8.36709 18.9022 8.28125 18.9412 8.1868C18.9801 8.09236 19.0001 7.99117 19 7.889C19 7.68266 18.918 7.48477 18.7721 7.33887C18.6262 7.19297 18.4283 7.111 18.222 7.111ZM10.444 5.556H13.555V7.111H10.444V5.556ZM15.044 18.778H8.96L8.047 8.667H15.952L15.044 18.778Z",fill:"#94A0B5"})),$=Be;var Ie=({className:e="",...t})=>{let i=K("remove-button",K);return E.createElement("button",{...t,className:i},E.createElement($,null))},ee=Ie;var Se=e=>{let{idOptions:t,loadOptions:i,operatorOptions:r,filterType:o,valueOptions:l,onRemove:d,onChangeIdSelect:s,index:n}=e;return u.createElement("div",{className:"filter-row"},u.createElement("div",{className:"filter-row__field filter-row__field__id"},u.createElement(R,{classNamePrefix:"select-id",name:`filters[${n}].id`,options:t,onChange:s})),u.createElement("div",{className:"filter-row__field filter-row__field__operator"},u.createElement(q,{className:"select-operator",name:`filters[${n}].operator`,options:r})),u.createElement("div",{className:"filter-row__field filter-row__field__values"},u.createElement(J,{classNamePrefix:"select-values",name:`filters[${n}].values`,type:o,valueOptions:l,loadOptions:i})),u.createElement("div",{className:"filter-row__field filter-row__remove"},u.createElement(ee,{onClick:()=>d(n)})))},te=Se;var re=(e,t)=>({filters:e.filters?.length?e.filters.map(r=>{let o=t.find(l=>r.id.value===l.value);return{values:r.values,operator:r.operator,id:o}}):[]}),oe=e=>e.map(t=>{let{caption:i,id:r,values:o,operators:l,...d}=t,s;Array.isArray(o)?s=o.map(c=>({label:c.name,value:String(c.id)})):s=o;let n=l.map(c=>({key:c,value:c}));return{label:i,value:String(r),values:s,operators:[{key:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440",value:""},...n],...d}}),ie=e=>({filters:e.filters.map(r=>{let{id:o,...l}=r;return{...l,id:{label:o.label,value:o.value}}})});var we=e=>{let{onSubmitFilterForm:t,initialFilters:i,filtersTypesList:r,onRemoveFilter:o,onAddFilter:l,onLoadSourceOptions:d,addFilterButtonText:s,submitFilterButtonText:n,idLabelText:c,operatorLabelText:m,valuesLabelText:y}=e,T=oe(r),ae=re(i,T);return p.createElement(Ee,{onSubmit:(_,U)=>{let V=ie(_);t&&t(V)},initialValues:ae,validationSchema:w,enableReinitialize:!0},p.createElement(Le,null,p.createElement(Ne,{name:"filters"},_=>{let{form:U,push:V,remove:se}=_,{filters:ne}=U.values,pe=f=>{se(f),o&&o(f)},ce=()=>{let[f=null]=T;V({id:f,operator:"",values:[]}),l&&l(_)};return p.createElement("div",{className:"filter-list"},p.createElement("div",{className:"filter-list-labels"},p.createElement("label",null,c),p.createElement("label",null,m),p.createElement("label",null,y)),p.createElement("ul",{className:"filter-list__items"},ne.map((f,x)=>{let de=()=>{U.setFieldValue(`filters[${x}].operator`,""),U.setFieldValue(`filters[${x}].values`,null)};return p.createElement("li",{className:"filter-list__item",key:x},p.createElement(te,{loadOptions:d(f?.id?.value),filterType:f?.id?.type,onChangeIdSelect:de,idOptions:T,operatorOptions:f?.id?.operators,valueOptions:f?.id?.values,onRemove:pe,index:x}))})),p.createElement("div",{className:"filter-list__button"},p.createElement("button",{type:"button",onClick:ce},s)))}),p.createElement("div",{className:"filter-list-submit"},p.createElement("button",{type:"submit"},n))))},le=we;export{le as TableFiltersClient};
//# sourceMappingURL=index.js.map
